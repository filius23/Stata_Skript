[
["lin-reg.html", "6 Regression 6.1 Beispieldatensatz 6.2 Idee einer Regression 6.3 Residuen 6.4 Interpretation der Regression 6.5 Übungen", " 6 Regression Mit Regressionsmodellen können wir Zusammenhänge zwischen zwei metrischen Merkmalen untersuchen. In Stata können wir eine Regression mit dem reg Befehl berechnen: Source | SS df MS Number of obs = 4 -------------+------------------------------ F( 1, 2) = 11.07 Model | 12.4932432 1 12.4932432 Prob &gt; F = 0.0797 Residual | 2.25675676 2 1.12837838 R-squared = 0.8470 -------------+------------------------------ Adj R-squared = 0.7705 Total | 14.75 3 4.91666667 Root MSE = 1.0623 ------------------------------------------------------------------------------ var2 | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- var1 | .5810811 .1746331 3.33 0.080 -.1703044 1.332467 _cons | 2.135135 .9485004 2.25 0.153 -1.945933 6.216203 ------------------------------------------------------------------------------ Hier steht jetzt eine ganze Menge an Informationen, die wir uns im Folgenden genauer ansehen werden. 6.1 Beispieldatensatz Zum Einstieg betrachten wir zunächst einen (fiktiven) Datensatz mit lediglich 4 Fällen und lediglich zwei Variablen: var1 und var2: use &quot;https://github.com/filius23/Stata_Skript/raw/master/regression_bsp.dta&quot;, clear list var1 var2 1 1 2 2 2 4 3 7 7 4 8 6 6.2 Idee einer Regression Ziel der Regression ist es, den Zusammenhang zwischen diesen beiden Variablen zu bestimmen. Gibt es einen Trend, in dem Sinn, dass ein höherer Wert von var1 mit einem höheren oder niedrigeren Wert von var2 einhergeht? Etwas anders gesagt könnte man auch fragen, welchen Wert für var2 wir vorhersagen würden, wenn wir var1 kennen. Ein Ausgangspunkt ist das arithmetische Mittel. Dieses können wir mit mean zB für var2 berechnen.1 Diesen Wert fügen wir als neue Spalte mean_var2 in den Datensatz ein: egen mean_var2 = mean(var2) list var1 var2 mean_var2 1 1 2 4.75 2 2 4 4.75 3 7 7 4.75 4 8 6 4.75 Müssten wir eine Prognose für die Werte von var2 abgeben, wäre das arith. Mittel eine gute Wahl. Die vorhergesagten Werte werden jeweils auf der Linie für das arith. Mittel liegen. 6.3 Residuen Allerdings liegen wir mit dem arith. Mittel dann immer auch Stück daneben. Diese Abweichung zwischen dem tatsächlichen und dem vorhergesagten Wert wird als Residuum bezeichnet, in unserem Beispiel ist das jeweils die Differenz zwischen var2 und mean: \\[Residuum = beobachteter\\, Wert \\; - \\; vorhergesagter\\,Wert\\] Als Formel wird das in der Regel wie folgt dargestellt: \\[\\epsilon_{\\text{i}} = \\text{y}_{i} - \\hat{\\text{y}}_{i}\\] Wir können also die Residuen als Differenz zwischen var2 und mean berechnen und in df ablegen: gen m_abw = var2 - mean_var2 list var1 var2 mean_var2 m_abw 1 1 2 4.75 -2.75 2 2 4 4.75 -0.75 3 7 7 4.75 2.25 4 8 6 4.75 1.25 Was bedeutet also ein negativer oder ein positiver Wert für das Residuum? Die horizontale Linie für das arithm. Mittel ist aber sehr deutlich nicht die beste Methode, um die Werte für var2 vorherzusagen. In der Graphik können wir deutlich sehen, dass die Werte “weiter links”, also mit geringeren Werten für var1, auch geringere Werte für var2 aufweisen. Wir könnten also unseren Vorhersagefehler bzw. das Residuum minimieren indem wir die Linie drehen. Die Idee der Regressionsanalyse ist es dabei, die Residuuen zu minimieren. Was würde aber passieren wenn wir die Residuen aus der Mittelwertsvorhersage aufsummieren, um Sie dann zu minimieren? 6.3.1 Quadrierte Residuen Mit total können wir die Summe für eine Variable bilden: var1 var2 mean_var2 m_abw 1 1 2 4.75 -2.75 2 2 4 4.75 -0.75 3 7 7 4.75 2.25 4 8 6 4.75 1.25 total m_abw Total estimation Number of obs = 4 -------------------------------------------------------------- | Total Std. Err. [95% Conf. Interval] -------------+------------------------------------------------ m_abw | 0 4.434712 -14.11323 14.11323 -------------------------------------------------------------- Die Summe der Resiuden auf Basis des arith. Mittels ist immer Null! Anders formuliert: die gestrichelten Linien nach oben sind in Summe genauso lang wie gestrichelten Linien nach unten. Die Lösung ist die Residuen zu quadrieren. So ergibt sich eine Kennzahl, die wir minimieren können: gen m_abw2 = m_abw^2 total m_abw2 Total estimation Number of obs = 4 -------------------------------------------------------------- | Total Std. Err. [95% Conf. Interval] -------------+------------------------------------------------ m_abw2 | 14.75 6.448514 -5.77205 35.27205 -------------------------------------------------------------- var1 var2 mean_var2 m_abw m_abw2 1 1 2 4.75 -2.75 7.5625 2 2 4 4.75 -0.75 0.5625 3 7 7 4.75 2.25 5.0625 4 8 6 4.75 1.25 1.5625 6.3.1.1 Vergleich zur Varianz Wir hatten gestern die Varianz kennen gelernt. Diese ist sehr ähnlich zu m_abw2: wenn wir die Summe von m_abw2 durch (\\(n\\)) die Zahl der Beobachtungen teilen, dann erhalten wir die Varianz: dis 14.75/4 3.6875 6.4 Interpretation der Regression Die Minimierung erledigt reg für uns. Hier geben wir zuerst das Merkmal an, das auf der y-Achse liegt (die abhängige Variable) und dann das Merkmal für die x-Achse (unabhängige Variable) an. Ein positiver Wert unter var1 bedeutet, dass unsere Gerade von links nach rechts ansteigt und ein negativer eine fallende Linie bedeuten würde. Der Wert unter var1 gibt an, um wieviel sich die Gerade pro “Schritt nach rechts” nach oben/unten verändert. Die Gerade steigt also pro Einheit von var1 um 0.5810811: reg var2 var1 Source | SS df MS Number of obs = 4 -------------+------------------------------ F( 1, 2) = 11.07 Model | 12.4932432 1 12.4932432 Prob &gt; F = 0.0797 Residual | 2.25675676 2 1.12837838 R-squared = 0.8470 -------------+------------------------------ Adj R-squared = 0.7705 Total | 14.75 3 4.91666667 Root MSE = 1.0623 ------------------------------------------------------------------------------ var2 | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- var1 | .5810811 .1746331 3.33 0.080 -.1703044 1.332467 _cons | 2.135135 .9485004 2.25 0.153 -1.945933 6.216203 ------------------------------------------------------------------------------ In unserer Grafik sieht diese Gerade so aus: ### Vorhergesagte Werte Wie hoch ist nun der vorhergesagte Wert auf Basis der blauen Gerade? Die vohergesagten Werte aus reg var2 var1 entsprechen einfach der Summe aus dem Wert unter Intercept und dem Koeffizienten neben var1 multipliziert mit dem jeweiligen Wert für var1.2 reg var2 var1, noheader var2 | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- var1 | .5810811 .1746331 3.33 0.080 -.1703044 1.332467 _cons | 2.135135 .9485004 2.25 0.153 -1.945933 6.216203 ------------------------------------------------------------------------------ \\[\\texttt{Intercept} + 0.5811 \\times \\texttt{var1}\\] Für die erste Zeile ergibt sich also folgender vorhergesagter Wert: 2.1351+0.5811*1= 2.7162 Also könnten wir mit gen die vorhergesagten Werte berechnen: gen reg_vohers = 2.1351 + 0.5811 * var1 Die vorhergesagten Werte können wir auch mit predict berechnen und in einer neuen Variable reg_vorhersagen ablegen: predict reg_vorhersagen, xb var1 var2 mean_var2 m_abw m_abw2 reg_vorhersagen 1 1 2 4.75 -2.75 7.5625 2.716216 2 2 4 4.75 -0.75 0.5625 3.297297 3 7 7 4.75 2.25 5.0625 6.202703 4 8 6 4.75 1.25 1.5625 6.783784 Die Grafik zeigt wie Vorhersagen auf Basis des Regressionsmodells aussehen: Sie entsprechen den Werten auf der blauen Geraden (der sog. Regressionsgeraden) an den jeweiligen Stellen für var1. Wir können erkennen, dass die hellblauen Punkte (also die Vorhersagen des Regressionsmodells) deutlich näher an den tatsächlichen Punkten liegen als die orangen Vorhersagen auf Basis des mean. 6.4.1 Residuen Trotzdem sind auch die hellblauen Punkte nicht deckungsgleich mit den tatsächlchen Werten. Es gibt also auch hier wieder Residuen, also Abweichungen des beobachteten vom vorhergesagten Wert. Wir können diese per Hand berechnen als Differenz zwischen dem tatsächlichen und dem vorhergesagten Wert: gen res = var2 - reg_vorhersagen Oder wir können Sie mit predict neue_variable , residuals erstellen: reg var2 var1 // zunächst nochmal die regression laufen lassen predict p_res , residuals list var1 var2 mean_var2 m_abw m_abw2 reg_vorhersagen res p_res 1 1 2 4.75 -2.75 7.5625 2.716216 -0.7162162 -0.7162162 2 2 4 4.75 -0.75 0.5625 3.297297 0.7027027 0.7027027 3 7 7 4.75 2.25 5.0625 6.202703 0.7972973 0.7972973 4 8 6 4.75 1.25 1.5625 6.783784 -0.7837838 -0.7837838 Hier sind die Residuen für p_res als hellblaue Linien eingezeichnet: Wie groß ist die Summe der Residuen für lm? 6.4.2 Modellgüte Um zu beurteilen, um wieviel besser unsere Gerade aus reg die Werte vorhersagt kann als der mean können wir die Summe der quadrierten Residuen vergleichen. Dazu quadrieren wir also die Residuen: gen res2 = res^2 list var1 var2 mean_var2 m_abw m_abw2 reg_vorhersagen res res2 1 1 2 4.75 -2.75 7.5625 2.716216 -0.7162162 0.5129657 2 2 4 4.75 -0.75 0.5625 3.297297 0.7027027 0.4937911 3 7 7 4.75 2.25 5.0625 6.202703 0.7972973 0.6356830 4 8 6 4.75 1.25 1.5625 6.783784 -0.7837838 0.6143170 Dann können wir die Summen der quadierten Abweichungen aus der Mittelwertregel und dem Regressionsmodell vergleichen: dis 7.5625+0.5625+5.0625+1.5625 // abw2 aus Mittelwertsregel 14.75 dis 0.5129657+0.4937911+0.6356830+0.6143170 // res2 aus regressionsmodell 2.2567568 Zum Beispiel können wir uns fragen, um wieviel sich die Summe der quadrierten Residuen verringert wenn wir statt des mean unser reg-Modell verwenden: dis 14.75 - 2.256757 12.493243 Wenn wir diese Veränderung ins Verhältnis mit dem “Ausgangswert”, also den Residuen aus der Mittelwertregel setzen, dann erhalten wir das \\(R^{2}\\) für unser reg-Modell. Dieses gibt die prozentuale Verringerung der Residuen durch das reg-Modell im Vergleich zur Mittelwertregel an: dis (14.75 - 2.256757) / 14.75 .84699953 Unser Regressionsmodell kann also 84,7% der Streuung um den Mittelwert erklären. Dieser Wert wird auch als \\(R^2\\) bezeichnet. Im Regressionsoutput können wir das \\(R^2\\) oben rechts unter R-squared ablesen. reg var2 var1 Source | SS df MS Number of obs = 4 -------------+------------------------------ F( 1, 2) = 11.07 Model | 12.4932432 1 12.4932432 Prob &gt; F = 0.0797 Residual | 2.25675676 2 1.12837838 R-squared = 0.8470 -------------+------------------------------ Adj R-squared = 0.7705 Total | 14.75 3 4.91666667 Root MSE = 1.0623 ------------------------------------------------------------------------------ var2 | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- var1 | .5810811 .1746331 3.33 0.080 -.1703044 1.332467 _cons | 2.135135 .9485004 2.25 0.153 -1.945933 6.216203 ------------------------------------------------------------------------------ Außerdem sehen wir oben links in der Spalte SS die “Sum of Squares”. Hier finden wir auch die Werte von oben wieder: unter Total ist die Summe der quadrierten Abweichungen der beobachteten Werte vom arith. Mittel angegeben (14.75, sozusagen die Summe der m_abw2 von oben). Residual gibt die Summe der Abweichungsquadrate zwischen den beobachteten Werten und den vorhergesagten Werten der Regression (2.256.., Die Summe von res2). 6.5 Übungen Mehr zu egen in Kapitel 2.11.5↩︎ Die Option noheader macht den Output von reg etwas übersichtlicher.↩︎ "]
]
